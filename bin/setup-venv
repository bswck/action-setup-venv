#!/usr/bin/env python3
import argparse
import hashlib
import io
import os.path
import secrets
import subprocess
import sys
import tarfile
import urllib.request
from typing import List

VENV_DIR=os.path.abspath(".venv")

def _command_vars(cache_key: str) -> int:
  with open(os.environ["GITHUB_OUTPUT"], "a+") as f:
    print(f"cache-key={cache_key}", file=f)
    print(f"venv-dir={VENV_DIR}", file=f)

  print(f"Cache key: {cache_key}")
  print(f"Venv dir: {VENV_DIR}")

  return 0

def main() -> int:
  parser = argparse.ArgumentParser()
  parser.add_argument("command", choices=("vars"))
  parser.add_argument("--python-version", required=True)
  parser.add_argument("--requirement-files-hash", required=True)
  args = parser.parse_args()

  cache_key = f"{sys.platform}-py-{args.python_version}-{args.requirement_files_hash}"

  return {
      "vars": _command_vars,
  }[args.command](cache_key)


if __name__ == "__main__":
    raise SystemExit(main())
